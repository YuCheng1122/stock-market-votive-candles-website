import * as echarts from 'echarts'
import ReactEcharts from 'echarts-for-react'
import ecStat from 'echarts-stat'
import { useEffect, useState } from 'react'

export default function AnalChart() {
	const [option, setOption] = useState(null)

	const data = [
		[24.2, 530],
		[23.7, 528],
		[23, 520],
		[22.9, 524],
		[23.4, 514],
		[22.5, 530],
		[29.1, 547],
		[26.3, 560],
		[29, 549],
		[29.5, 540],
		[27.8, 540],
		[22.9, 535],
		[22.2, 544],
		[25.1, 541],
		[26.6, 530],
		[28.8, 516],
		[29.4, 513],
		[26.1, 509],
		[26.2, 508],
		[28.2, 501],
		[30.1, 498],
		[29.2, 505],
		[30.1, 494.5],
		[29.3, 485.5],
		[27.4, 486.5],
		[29, 498.5],
		[29.8, 497.5],
		[29.9, 491],
		[30.7, 476],
		[30.2, 453.5],
		[28.4, 440],
		[27.6, 446],
		[29.4, 435.5],
		[29.2, 457.5],
		[30.4, 467],
		[31.6, 462],
		[31.3, 449.5],
		[30.8, 470.5],
		[31.2, 475],
		[31.7, 492.5],
		[31.1, 495.5],
		[29.7, 491],
		[29.4, 495],
		[31.7, 501],
		[32.6, 503],
		[32, 499.5],
		[30.9, 495],
		[31.3, 502],
		[30.7, 501],
		[30.5, 509],
		[30, 504],
		[27.4, 492],
		[29.5, 501],
		[29.3, 500],
		[30, 516],
		[31.1, 512],
		[31.2, 510],
		[30.9, 500],
		[30.8, 514],
		[30.5, 517],
		[30.9, 523],
		[30.3, 525],
		[30.8, 527],
		[30.2, 520],
		[30.3, 519],
		[32.1, 512],
		[31.8, 504],
		[31.6, 503],
		[29.1, 508],
		[30.9, 512],
		[30.5, 498.5],
		[30.8, 496],
		[30.5, 505],
		[28, 490.5],
		[26.6, 485],
		[29.5, 486],
		[27.2, 489],
		[27.7, 472.5],
		[27.5, 475],
		[26, 486.5],
		[26, 493],
		[27.4, 480],
		[27.5, 476.5],
		[27.9, 472],
		[27.8, 467],
		[26.4, 476.5],
		[25.9, 471],
		[26.2, 464.5],
		[26, 455],
		[28.3, 446.5],
		[28.9, 448],
		[29.6, 438],
		[30, 435],
		[29.6, 422],
		[30.4, 417],
		[29.4, 429],
		[26.7, 445],
		[25.5, 451],
		[25.2, 438],
		[21.2, 401.5],
		[22.1, 397.5],
		[23.1, 395],
		[23.7, 412],
		[23.1, 397],
		[19.2, 407],
		[21.2, 395.5],
		[22.9, 397.5],
		[24.4, 389.5],
		[22.4, 387],
		[22.1, 371],
		[23.9, 376],
		[24.7, 385.5],
		[23.8, 379.5],
		[22.3, 390],
		[20.9, 391.5],
		[21.9, 395],
		[23.4, 384],
		[21.4, 382],
		[22.7, 390],
		[22.8, 399],
		[26.1, 417],
		[25.9, 407.5],
		[26.1, 441.5],
		[24.2, 445],
		[25.5, 480],
		[23.3, 487],
		[24.3, 485],
		[25.1, 487],
		[24.3, 482],
		[25.8, 491],
		[22.2, 492],
		[20.8, 496],
		[22.1, 498],
		[25.5, 480.5],
		[26.5, 487],
		[19.6, 490],
		[17.9, 498.5],
		[19, 492.5],
		[19.2, 489],
		[17.6, 478],
		[19.1, 475],
		[18.7, 471.5],
		[18.7, 481.5],
		[16.4, 475],
		[15.7, 471.5],
		[14.7, 480.5],
		[16.6, 480.5],
		[18.7, 471],
		[14.8, 466.5],
		[19.4, 457.5],
		[15.8, 459],
		[14.3, 468],
		[12.1, 455],
		[15.1, 456.5],
		[16.5, 457],
		[16.9, 451],
		[16.4, 446],
		[16.5, 448.5],
		[16.1, 453],
		[16.3, 449.5],
		[19.3, 458.5],
		[18.2, 458.5],
		[20.3, 481],
		[19.8, 486],
		[20.7, 484.5],
		[21.5, 486.5],
		[23.2, 500],
		[12.8, 505],
		[15.2, 503],
		[14.7, 543],
		[16.5, 522],
		[17.6, 530],
		[17.5, 540],
		[17.5, 542],
		[17.6, 526],
		[18.8, 523],
		[19.4, 540],
		[18.5, 540],
		[18.2, 545],
		[20.8, 541],
		[13.9, 545],
		[12.8, 525],
		[15.9, 528],
		[19, 518],
		[15.3, 517],
		[14.1, 516],
		[16.3, 507],
		[18.8, 518],
		[17.3, 511],
		[18.6, 522],
		[16.7, 519],
		[17.2, 516],
		[18.9, 521],
		[20.5, 524],
		[20.3, 521],
		[20, 522],
		[21.6, 513],
		[14.7, 516],
		[18.8, 510],
		[20.7, 511],
		[22.3, 505],
		[22.3, 518],
		[21.5, 512],
		[24, 517],
		[26.4, 533],
		[25.1, 538],
		[22.1, 539],
		[17.1, 531],
		[18, 525],
		[20.7, 530],
		[19.1, 535],
		[18.6, 533],
		[23.4, 530],
		[17.6, 531],
		[22.7, 529],
		[24.4, 524],
		[23.5, 520],
		[25.8, 510],
		[25.8, 516],
		[26.1, 520],
		[27.1, 515],
		[25.5, 510],
		[22.9, 513],
		[21.2, 511],
		[21.2, 507],
		[20, 498],
		[18.8, 491.5],
		[22.2, 493.5],
		[25.1, 502],
		[26.6, 501],
		[28, 496],
		[28.3, 498],
		[29.4, 500],
		[19.9, 504],
		[20.7, 510],
		[22.4, 503],
		[24.3, 499],
		[24.7, 496],
		[25.1, 495.5],
		[26.9, 505],
		[28.3, 519],
		[29.9, 530],
		[24.1, 532],
	]

	useEffect(() => {
		echarts.registerTransform(ecStat.transform.regression)

		const option = {
			dataset: [
				{
					source: data,
				},
				{
					transform: {
						type: 'ecStat:regression',
					},
				},
			],
			title: {
				text: '2330 台積電的股價與氣溫的相關性分析',
				left: 'center',
				textStyle: {
					color: '#252525',
					fontSize: '1.2rem',
				},
			},
			legend: {
				bottom: 5,
			},
			tooltip: {
				trigger: 'axis',
				axisPointer: {
					type: 'cross',
				},
			},
			xAxis: {
				type: 'value',
				min: 10,
				max: 35,
			},
			yAxis: {
				type: 'value',
				min: 300,
				max: 600,
			},
			series: [
				{
					name: '',
					type: 'scatter',
				},
				{
					name: 'line',
					type: 'line',
					datasetIndex: 1,
					symbolSize: 0.1,
					symbol: 'circle',
					label: { show: true, fontSize: 16 },
					labelLayout: { dx: -20 },
					encode: { label: 2, tooltip: 1 },
				},
			],
			grid: {
				x: 40,
				y: 60,
				x2: 8,
				y2: 60,
			},
		}

		setOption(option)
	}, [])

	return (
		<>
			{option && (
				<ReactEcharts
					option={option}
					style={{
						height: '100%',
						width: '100%',
					}}
				/>
			)}
		</>
	)
}
